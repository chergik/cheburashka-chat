// Generated by CoffeeScript 1.9.0
(function() {
  'use strict';
  define(function(require) {
    var AppView, Backbone, MessageBoxView, MessagesCollection, UsersCollection, chat;
    Backbone = require('backbone');
    UsersCollection = require('collections/users');
    MessagesCollection = require('collections/messages');
    MessageBoxView = require('views/message_box');
    chat = require('lib/chat')();
    return AppView = Backbone.View.extend({
      el: '#app',
      initialize: function() {},
      render: function() {
        var messageBoxView, messagesListView, usersListView;
        this.username = prompt("What is your name?");
        usersListView = new UsersListView({
          collection: new UsersCollection()
        });
        this.$el.append(usersListView.render().el);
        messagesListView = new MessagesListView({
          collection: new MessagesCollection()
        });
        this.$el.append(messagesListView.render().el);
        messageBoxView = new MessageBoxView();
        this.$el.append(messageBoxView.render().el);
        chat.join(this.username);
        return this;

        /*
        socket = io()
        username = prompt "What is your name?"
        
        $('h2.username').text username
        $('title').text "Chat: #{username}"
        form = $('form[name="send_message"]')
        message = form.find 'input[name="message"]'
        
        addMessage = (msg) ->
          $('ul.messages').append $("<li class='message'>").html(msg)
        
        addUser = (user) ->
          $('ul.users').append $("<li class='user' data-name='#{user}'>")
            .html(user)
        
        remUser = (username) ->
          $("ul.users li[data-name=#{username}]").remove()
        
        socket.on 'remove user', remUser
        
        socket.on 'chat message', addMessage
        
        socket.on 'join', addUser
        
        form.submit (e) ->
          e.preventDefault()
          socket.emit 'chat message', $(message).val()
          $(message).val ''
          false
        
        socket.emit 'join', username
         */
      }
    });
  });

}).call(this);
